<div [@fadeInOut] class="fondo">
    <app-cabecera></app-cabecera>
    <main>

        @if (usuarioLogueado == null) {
        <h2 style="color: rgb(15, 94, 1); background: rgba(245, 222, 179, 0.439); border-radius: 10px; padding: 4px;">
            Bienvenido a
            Ocio en Vivo, donde podrás
            conocer gente nueva y
            pasar un
            día espectacular</h2>
        <div style="margin-top: 5%;">
            <div class="carousel">
                <p-carousel [value]="listaActividades" [numVisible]="3" [numScroll]="2" [circular]="true"
                    autoplayInterval="7000">
                    <ng-template let-actividad pTemplate="item">
                        <div class="border-1 surface-border border-round m-2 text-center py-5 px-3 carusel">
                            <div class="mb-3">
                                <img [src]="actividad.imagen" [alt]="actividad.nombre" class="w-6 shadow-2"
                                    style="width: 100%;" />
                            </div>
                            <div>
                                <h4 class="mb-1">{{ actividad.nombre }}</h4>
                                <h6 class="mt-0 mb-3">{{ actividad.descripcion }}</h6>
                                <div class="mt-5 flex align-items-center justify-content-center gap-2">
                                    <p-rating [(ngModel)]="actividad.puntuacion" [cancel]="false"
                                        [readonly]="true"></p-rating>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </p-carousel>
            </div>
        </div>
        }@else {

        <div style="margin-top: 5%;">
            <div class="carousel">
                <p-carousel [value]="listaActividades" [numVisible]="3" [numScroll]="2" [circular]="true"
                    autoplayInterval="7000">
                    <ng-template let-actividad pTemplate="item">
                        <div class="border-1 surface-border border-round m-2 text-center py-5 px-3 carusel">
                            <div class="mb-3">
                                <img [src]="actividad.imagen" [alt]="actividad.nombre" class="w-6 shadow-2"
                                    style="width: 100%;" />
                            </div>
                            <div>
                                <h4 class="mb-1">{{ actividad.nombre }}</h4>
                                <h6 class="mt-0 mb-3">{{ actividad.descripcion }}</h6>
                                <div class="mt-5 flex align-items-center justify-content-center gap-2">
                                    <p-rating [(ngModel)]="actividad.puntuacion" [cancel]="false"
                                        [readonly]="true"></p-rating>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </p-carousel>
            </div>
        </div>
        @if (usuarioLogueado.role.id === 1) {
        <div class="d-flex" style="justify-content: space-around; margin: 10%;">

            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Ofertar Actividad">
                        </div>
                        <div class="activity-info">
                            <h2>Ofertar Actividad</h2>
                            <p>Publica aquí tus actividades favoritas. </p>
                            <div class="d-flex" style="justify-content: center; align-items: center;">
                                <button type="button" (click)="mostrarFormulario()" class="btn">Ofertar
                                    ahora</button>
                                <button class="btn" routerLink="/actividades/usuario/ofertante">Mis
                                    Actividades</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Ofertar Actividad">
                        </div>
                        <div class="activity-info">
                            <h2>Solicitudes</h2>
                            <p>Haz click aquí para crear nuevas solicitudes.</p>
                            <div class=" d-flex" style="justify-content: center; align-items: center; margin-top: 5%;">
                                <button class="btn" (click)="abrirCerrarPanelCrearSolicitud()">Crear
                                    Solicitudes</button>
                                <button class="btn" routerLink="/solicitudes">Mis solicitudes</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Buscar Actividades">
                        </div>
                        <div class="activity-info">
                            <h2>Buscar Actividades</h2>
                            <p>Consulta aquí tus actividades favoritas y conoce gente.
                            </p>
                            <div class="d-flex" style="justify-content: center; align-items: center;">
                                <button class="btn" routerLink="/actividades">Buscar ahora</button>

                            </div>
                        </div>
                    </div>
                </article>
            </section>

            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Lista de Solicitudes">
                        </div>
                        <div class="activity-info">
                            <h2>Lista de Solicitudes</h2>
                            <p>Consulta aquí las solicitudes de los usuarios consumidores.</p>
                            <div class="d-flex" style="justify-content: center; align-items: center;">
                                <button type="button" class="btn" routerLink="/lista-solicitudes">Consultar
                                    Solicitudes</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>

        </div>
        }
        @if (usuarioLogueado.role.id === 2) {
        <div class="d-flex" style="justify-content: space-around; margin: 10%;">
            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Ofertar Actividad">
                        </div>
                        <div class="activity-info">
                            <h2>Ofertar Actividad</h2>
                            <p>Publica aquí tus actividades favoritas. </p>
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <button type="button" (click)="mostrarFormulario()" class="btn">Ofertar
                                    ahora</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Buscar Actividades">
                        </div>
                        <div class="activity-info">
                            <h2>Buscar Actividades</h2>
                            <p>Consulta aquí tus actividades favoritas y conoce gente.
                            </p>
                            <div class="d-flex" style="justify-content: center; align-items: center;">
                                <button class="btn" routerLink="/actividades">Buscar ahora</button>
                                <button class="btn" routerLink="/actividades/usuario/ofertante">Mis
                                    Actividades</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>

            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Lista de Solicitudes">
                        </div>
                        <div class="activity-info">
                            <h2>Lista de Solicitudes</h2>
                            <p>Consulta aquí las solicitudes de los usuarios consumidores.</p>
                            <div style="display: flex; justify-content: center; align-items: center;">
                                <button type="button" class="btn" routerLink="/lista-solicitudes">Consultar
                                    Solicitudes</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Lista de Solicitudes">
                        </div>
                        <div class="activity-info">
                            <h2>Tus Actividades</h2>
                            <p>Consulta aquí tus actividades</p>
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <button type="button" class="btn" routerLink="/actividades/usuario">Ver
                                    ahora</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>

        </div>
        }
        @if (usuarioLogueado.role.id === 3) {
        <div class="d-flex" style="justify-content: space-around; margin: 10%;">

            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Ofertar Actividad">
                        </div>
                        <div class="activity-info">
                            <h2>Solicitudes</h2>
                            <p>Haz click aquí para crear nuevas solicitudes.</p>
                            <div class="d-flex" style="justify-content: center; align-items: center; margin-top: 5%;">
                                <button class="btn" (click)="abrirCerrarPanelCrearSolicitud()">Crear
                                    Solicitudes</button>
                                <button class="btn" routerLink="/solicitudes">Mis solicitudes</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>
            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Buscar Actividades">
                        </div>
                        <div class="activity-info">
                            <h2>Buscar Actividades</h2>
                            <p>Consulta aquí tus actividades favoritas y conoce gente.
                            </p>
                            <div class="d-flex" style="justify-content: center; align-items: center;">
                                <a class="btn" routerLink="/actividades">Buscar ahora</a>
                            </div>
                        </div>
                    </div>
                </article>
            </section>

            <section>
                <article>
                    <div class="activity-card">
                        <div class="activity-image">
                            <img src="assets/act/imagenAct_1.jpg" alt="Lista de Solicitudes">
                        </div>
                        <div class="activity-info">
                            <h2>Tus Actividades</h2>
                            <p>Consulta aquí tus actividades</p>
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <button type="button" class="btn" routerLink="/actividades/usuario">Ver
                                    ahora</button>
                            </div>
                        </div>
                    </div>
                </article>
            </section>

        </div>
        }
        }
        @if(crearSolicitud){
        <div>
            <app-crear-solicitud
                (abrirCerrarPanelCrearSolicitud)="abrirCerrarPanelCrearSolicitud()"></app-crear-solicitud>
        </div>
        }

        @if (m_formulario_actividadAdd) {

        <div class="modal-overlay" [@fadeInOut]="true">
            <div class="modal-content">
                <form #addActividad="ngForm" (ngSubmit)="onSubmitAdd(actividadAdd)">
                    <span class="close-button" (click)="cerrarFormAdd()"><i>Cerrar</i></span>
                    <div class="modal-header">
                        <h2 class="modal-title" style="color: blue;">Añadir Actividad</h2>
                    </div>
                    <p-tabMenu [model]="itemsMenu">
                        <ng-template pTemplate="item" let-item>
                            <ng-container>
                                <a class="p-menuitem-link">
                                    <span [class]="item.icon"></span>
                                    <span class="ml-2">
                                        {{ item.label }}
                                    </span>
                                </a>
                            </ng-container>
                        </ng-template>
                    </p-tabMenu>

                    <div class="modal-body mt-4">
                        @if (!generalForm && !fechaForm) {
                        <h1 class="text-center">HAZ CLICK PARA MOSTRAR LOS FORMULARIOS </h1>
                        }
                        @if (generalForm) {
                        <div [@slideInOutForm]="true">
                            <input type="hidden" class="form-control" id="id_usuario_creador" name="id_usuario_creador"
                                [(ngModel)]="actividadAdd.id_usuario_creador">
                            <div style=" display: flex; justify-content: space-between;" class="row">
                                <div class="form-floating mb-5 col-5">
                                    <input type="text" class="form-control" id="nombre" name="nombre"
                                        placeholder="Nombre" [(ngModel)]="actividadAdd.nombre" required>
                                    <input type="text" class="form-control" id="ciudad" name="ciudad"
                                        placeholder="Ciudad" [(ngModel)]="actividadAdd.ciudad" required>
                                    <input type="number" class="form-control" id="precio" name="precio"
                                        placeholder="Precio" [(ngModel)]="actividadAdd.precio" required>

                                </div>
                                <div class="form-floating mb-4 col-7">
                                    <textarea rows="6" cols="40" pInputTextarea [(ngModel)]="actividadAdd.descripcion"
                                        aria-placeholder="Descipción" name="descripcion" required>
                                            </textarea>
                                </div>
                            </div>


                            <div class="row">
                                <div class="d-flex" style="justify-content: space-around;">
                                    <ul style="list-style: none; align-items: center; justify-content: center;">
                                        <li class="mb-3">
                                            <input type="checkbox" class="form-check-input" id="personal"
                                                name="personal" [(ngModel)]="actividadAdd.personal" required>
                                            <label for="personal"
                                                class="form-check-label"><strong>Personal</strong></label>
                                        </li>

                                        <li class="mb-3">
                                            <input type="checkbox" class="form-check-input" id="trasporte"
                                                name="trasporte" [(ngModel)]="actividadAdd.trasporte" required>
                                            <label for="trasporte"
                                                class="form-check-label"><strong>Transporte</strong></label>
                                        </li>

                                        <li class="mb-3">
                                            <input type="checkbox" class="form-check-input" id="material"
                                                name="material" [(ngModel)]="actividadAdd.material" required>
                                            <label for="material"
                                                class="form-check-label"><strong>Meterial</strong></label>
                                        </li>
                                    </ul>
                                    <div class="col-6"></div>
                                    <div class="form-floating  col-6" style="margin-left: 100px;">
                                        <input type="number" class="form-control" id="n_plazas" name="n_plazas"
                                            placeholder="Número de Plazas" [(ngModel)]="actividadAdd.n_plazas" required>
                                        <div class="d-flex">
                                            <input type="number" class="form-control" id="n_plazas_min"
                                                name="n_plazas_min" placeholder="Plazas Mínimas"
                                                [(ngModel)]="actividadAdd.n_plazas_min" required>

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="d-flex">
                                <div class="col-4">
                                    <input type="text" class="form-control" id="preparacion_f" name="preparacion_f"
                                        placeholder="Preparación Física" [(ngModel)]="actividadAdd.preparacion_f"
                                        required>
                                </div>
                            </div>
                        </div>
                        }
                        @if (fechaForm) {

                        <div [@slideInOutForm]>
                            <div class="row">
                                <div class="col-12 d-flex mb-4">
                                    <div class="form-floating col-4">
                                        <label for="dia" class="form-label mt-4">Día de la Actividad</label>
                                        <input type="date" class="form-control" id="dia" name="dia"
                                            [(ngModel)]="actividadAdd.dia" required>
                                    </div>
                                    <div class="col-1"></div>
                                    <div class="form-floating col-3">
                                        <label for="duracion_aprox" class=" form-label">Duración Aproxinada</label>
                                        <input type="time" class="form-control" id="duracion_aprox"
                                            name="duracion_aprox" [(ngModel)]="actividadAdd.duracion_aprox" required>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-12 d-flex mb-4">
                                    <div class="form-floating col-2">
                                        <label for="hora_inicio" class="form-label">Hora Inicio</label>
                                        <input type="time" class="form-control" id="hora_inicio" name="hora_inicio"
                                            [(ngModel)]="actividadAdd.hora_inicio" required>
                                    </div>
                                    <div class="col-0"></div>
                                    <div class="form-floating col-2 mt-4">
                                        <label for="hora_fin" class="form-label">Hora Fin</label>
                                        <input type="time" class="form-control" id="hora_fin" name="hora_fin"
                                            [(ngModel)]="actividadAdd.hora_fin" required>
                                    </div>
                                    <div class="col-0"></div>

                                </div>
                            </div>

                            <button type="submit" class="button" [disabled]="!addActividad.valid">Crear
                                Actividad</button>

                        </div>
                        }


                    </div>
                </form>

            </div>
        </div>}
    </main>